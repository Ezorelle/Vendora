<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vendora â€“ Discover Vendors</title>
  <link rel="stylesheet" href="styles/Style.css" >
  <link rel="stylesheet"   href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
</head>
<body>
  
 <!-- Navbar -->
<header class="navbar">
  <div class="logo"><a href="index.html">Vendora</a></div>

  <div class="search-container">
    <input type="text" placeholder="Search vendors, categoriesâ€¦" class="search-input" />
    <button class="search-btn"><i class="fas fa-search"></i></button>
  </div>

  <nav>
    <ul class="nav-links">
      <li><a href="vendors.html">Vendors</a></li>

      <li class="nav-categories">
        <button type="button" id="categoriesBtn" class="categories-btn">
          Categories <i class="fas fa-chevron-down"></i>
        </button>
        <ul id="categoriesDropdown" class="categories-dropdown hidden">
          <li>All</li>
          <li>Clothing</li>
          <li>Electronics</li>
          <li>Beauty</li>
          <li>Home & Living</li>
        </ul>
      </li>

      <li class="nav-cart">
        <a href="cart.html"><i class="fas fa-shopping-cart"></i><span id="cartCountNav">0</span></a>
      </li>
      <li class="nav-settings">
        <a href="settings.html"><i class="fas fa-cog"></i></a>
      </li>
      <li class="nav-user">
        <a href="profile.html"><i class="fas fa-user-circle"></i></a>
      </li>
    </ul>
  </nav>
</header>

  <!-- Hero -->
  <section class="hero">
    <h1>Discover Local Vendors with Style</h1>
    <p>Explore unique products, services, and talents from your community.</p>
    <button class="cta-btn">Explore Vendors</button>
  </section>

  <!-- Ad Section (placeholder / live toggle) -->
  <div id="ad-slot"></div>
  <script>
    if (location.hostname === "localhost" || location.hostname.includes("127.0.0.1")) {
      document.getElementById("ad-slot").innerHTML =
        '<div style="width:100%;height:90px;background:#ccc;text-align:center;line-height:90px;">[Ad Placeholder]</div>';
    } else {
      document.getElementById("ad-slot").innerHTML = `
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"><\/script>
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-XXXXXX"
             data-ad-slot="1234567890"
             data-ad-format="auto"></ins>
        <script>(adsbygoogle = window.adsbygoogle || []).push({});<\/script>
      `;
    }
  </script>

  <!-- Slideshow (static) -->
  <section class="vendor-slideshow">
    <h2>Featured Vendors</h2>
    <div class="slideshow-container">
      <!-- your slides here -->
    </div>
  </section>

  <!-- Best Sellers (placeholder container for dynamic) -->
  <section class="item-showcase">
    <h2>Best Sellers</h2>
    <div id="best-sellers-container"></div>
  </section>

  <!-- Latest Items (placeholder container) -->
  <section class="item-showcase latest-items">
    <div class="glow-section">
      <div class="glow-box">
        <h1 class="glow-text">Latest Items</h1>
        <p class="glow-sub">Fresh drops just for you</p>
      </div>
    </div>
    <div id="latest-items-container"></div>
  </section>

  
  <!-- Footer -->
  <footer class="footer">
    <div class="seller-login-cta">
      <h2>Are You a Seller?</h2>
      <a href="seller/Seller_login.html"><button><span>Login</span></button></a>
    </div>
    <p>Cash Rules Everything Around Me</p>
    <p>&copy; 2025 Ezorelle. All rights reserved.</p>
  </footer>
  ...
  <!-- Chat -->
  <div id="chatBtn"><i class="fas fa-comment-dots"></i></div>
  <div id="chatWindow" class="chat-window">
    <div class="chat-header">
      <span>Assistant</span>
      <button id="closeChat">&times;</button>
    </div>
    <div class="chat-body" id="chatBody">
      <p>Hello my name is Jones 1.0ðŸ‘‹</p>
      <p>how can I help you today?</p>
    </div>
    <div class="chat-footer">
      <input type="text" id="chatInput" placeholder="Type a message..." />
      <button id="sendChat"><i class="fas fa-paper-plane"></i></button>
    </div>
  </div>

<script>

async function loadProducts() {
  const latestContainer = document.getElementById("latest-items-container");
  const bestSellersContainer = document.getElementById("best-sellers-container");

  try {
    const res = await fetch("/api/products");
    const products = await res.json();

    latestContainer.innerHTML = "";
    bestSellersContainer.innerHTML = "";

    if (!products.length) {
      latestContainer.innerHTML = "<p>No products yet.</p>";
      bestSellersContainer.innerHTML = "<p>No products yet.</p>";
      return;
    }

    function createCard(p) {
      const card = document.createElement("div");
      card.classList.add("product-card", "item-card");
      card.innerHTML = `
        <img src="${p.image}" alt="${p.name}">
        <h3>${p.name}</h3>
        <p>KSh ${p.price}</p>
        <p>${p.category}</p>
        <div class="item-info" style="display:none;">
          <p>${p.description || "Fresh stock just for you!"}</p>
        </div>
        <button class="quick-add-btn">Add to Cart</button>
      `;

      // Open modal on card click (excluding quick-add button)
     card.addEventListener("click", (e) => {
  if (e.target.classList.contains("quick-add-btn")) return;
  window.location.href = `product.html?id=${p._id}`;
});

      // Quick Add to Cart
      const quickAddBtn = card.querySelector(".quick-add-btn");
      quickAddBtn.addEventListener("click", () => {
        const cart = JSON.parse(localStorage.getItem("cart")) || [];
        const price = parseFloat(p.price);
        const product = {
          title: p.name,
          price: price,
          qty: 1,
          img: p.image,
          total: price,
        };

        const existing = cart.find(item => item.title === product.title);
        if (existing) {
          existing.qty += 1;
          existing.total = existing.qty * existing.price;
        } else {
          cart.push(product);
        }

        localStorage.setItem("cart", JSON.stringify(cart));
        renderCart();        // re-render navbar cart
        updateCartCount();   // update cart count badge
        alert(`${p.name} added to cart!`);
      });

      return card;
    }

    // Latest products
    const latestProducts = products.slice(0, 6);
    latestProducts.forEach(p => latestContainer.appendChild(createCard(p)));

    // Best Sellers (highest stock)
    const bestSellers = [...products].sort((a, b) => b.stock - a.stock).slice(0, 6);
    bestSellers.forEach(p => bestSellersContainer.appendChild(createCard(p)));

  } catch (err) {
    console.error("Error loading products:", err);
    latestContainer.innerHTML = "<p>Failed to load products.</p>";
    bestSellersContainer.innerHTML = "<p>Failed to load products.</p>";
  }
}

document.addEventListener("DOMContentLoaded", loadProducts);

</script>


</body>
<script src="scripts/script.js"></script>
</body>
</html>